CREATE TABLE clients(
	C_ID INT NOT NULL PRIMARY KEY,
	C_Lname  VARCHAR(20) NOT NULL,
	C_Fname  VARCHAR(20) NOT NULL,
	C_Mi  VARCHAR(20) NOT NULL,
	C_Gen  VARCHAR(20) NOT NULL,
	C_Bday  date,
	A_id INT,
);

CREATE TABLE agents(
	A_ID INT NOT NULL PRIMARY KEY,
	A_Lname  VARCHAR(20) NOT NULL,
	A_Fname  VARCHAR(20) NOT NULL,
	A_Mi  VARCHAR(20) NOT NULL,
	A_Gen  VARCHAR(20),
	A_Bday  date,
	A_DeptID int
);

CREATE TABLE departments(
	DeptID INT NOT NULL PRIMARY KEY,
	Description text,
	Manager_ID  INT,
);


CREATE TABLE manager(
	ManagerID INT NOT NULL PRIMARY KEY,
	M_Lname  VARCHAR(20) NOT NULL,
	M_Fname  VARCHAR(20) NOT NULL,
	M_Mi  VARCHAR(20) NOT NULL,
	M_Gen  VARCHAR(20) NOT NULL,
	M_bday  DATE
);


SELECT * FROM clients;
	
INSERT INTO clients(C_ID,C_Lname,C_Fname,C_Mi,C_Gen,C_Bday, A_id)
VALUES
(1001, 'TORRES',    'ANDREA',    'T.', 'FEMALE', '12-10-1994', 2002),
(1002, 'RIVERA',    'MARIAN',    'R.', 'FEMALE', '03-25-1996', 2001),
(1003, 'GOMEZ',     'RICHARD',   'S.', 'MALE','10-12-1990',2001),
(1004, 'CRUZ',      'JOHN LLOYD','P.', 'MALE','03-02-1993',2002), 
(1005, 'ALAWI',     'IVANA',     'D.', 'FEMALE','08-23-2000',2003),
(1006, 'MANALO',    'JOSE',      'T.', 'MALE','11-12-1985',2001),
(1007, 'MORENO',    'ISKO',      'D.', 'MALE','02-14-1988',2001), 
(1008, 'AVELLANA',  'CARLA',     'P.', 'FEMALE','11-23-2008',2002),    
(1009, 'CRUZ',      'SUNSHINE',  'O.', 'FEMALE','05-30-1982',2003), 
(1010, 'CONCEPCION','GABBY',     'A.', 'MALE','09-30-1976',2001);


SELECT * FROM clients;
INSERT INTO agents(A_ID,A_Lname,A_Fname,A_Mi,A_Gen,A_Bday,A_DeptID)
VALUES
(2001, 'JORDAN','MICHAEL','Y.', 'MALE','08-22-1978', 7001),
(2202, 'WINSLET','KATE','P.','FEMALE','01-10-1987',7002),
(2003,'CRUISE','TOM','L.','MALE','11-24-1978',7003);

SELECT * FROM departments;
INSERT INTO departments(DeptID,Description,Manager_ID)
VALUES
(7001,'MARKETING',9001),  
(7002, 'FINANCE',9002), 
(7003, 'UTILITY', 9003);

SELECT * FROM manager;
INSERT INTO manager(ManagerID,M_Lname,M_Fname,M_Mi,M_Gen,M_bday)
VALUES
(9001,'CACHO','DHAN','C.','MALE','11-26-1979'),
(9002,'CONSTANTINO','ROMMEL','J.','MALE','05-10-1988'),
(9003,'GOLO','MARIAN','P.','FEMALE','07-21-2004');

SELECT * FROM CLIENTS INNER JOIN AGENTS ON CLIENTS.A_ID=AGENTS.A_ID;

SELECT * FROM DEPARTMENTS INNER JOIN MANAGER ON DEPARTMENTS.Manager_ID=MANAGER.MANAGERID;

SELECT CLIENTS.C_LNAME,CLIENTS.C_FNAME,CLIENTS.C_MI,AGENTS.A_LNAME,AGENTS.A_FNAME,AGENTS.A_MI FROM CLIENTS INNER JOIN AGENTS ON CLIENTS.A_ID=AGENTS.A_ID;

SELECT CLIENTS.C_LNAME,CLIENTS.C_FNAME,CLIENTS.C_MI,DEPARTMENTS.DESCRIPTION FROM CLIENTS INNER JOIN AGENTS ON CLIENTS.A_ID=AGENTS.A_ID INNER JOIN DEPARTMENTS ON AGENTS.A_DEPTID=DEPARTMENTS.DEPTID;

select AGENTS.A_Lname, count(*) as TOTALCLIENTS from clients inner join agents on clients.C_ID= AGENTS.A_id where agents.A_ID = 2001;

SELECT C_Lname
 FROM clients
  WHERE C_Lname LIKE 'c%';

SELECT CLIENTS.C_LNAME,CLIENTS.C_FNAME,CLIENTS.C_MI,DEPARTMENTS.DESCRIPTION FROM CLIENTS INNER JOIN AGENTS ON CLIENTS.A_ID=AGENTS.A_ID INNER JOIN DEPARTMENTS ON AGENTS.A_DEPTID=DEPARTMENTS.DEPTID;

SELECT NOW() AS TODAY FROM CLIENTS;

SELECT CLIENTS.C_LNAME,CLIENTS.C_FNAME,CLIENTS.C_MI,DEPARTMENTS.DESCRIPTION FROM CLIENTS INNER JOIN AGENTS ON CLIENTS.A_ID=AGENTS.A_ID INNER JOIN DEPARTMENTS ON AGENTS.A_DEPTID=DEPARTMENTS.DEPTID;

SELECT MANAGER.M_Lname,MANAGER.M_Fname,MANAGER.M_Mi, COUNT(*) FROM MANAGER

SELECT MANAGER.M_Lname,MANAGER.M_Fname,MANAGER.M_Mi, MANAGER INNER JOIN clients ON MANAGERID=clients.c_ID INNER JOIN DEPARTMENTS ON MANAGERID=DEPARTMENTS.DEPTID;

SELECT MANAGER.M_Lname,MANAGER.M_Fname,MANAGER.M_Mi, COUNT(clients.C_ID) From clients Right join agents on CLIENTS.A_ID=AGENTS.A_ID INNER JOIN DEPARTMENTS ON AGENTS.A_DEPTID=DEPARTMENTS.DEPTID inner join manager on manager.managerid = department.managerid group by manager.managerid;